{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/2016/11/mobile-reverse-code-engineering","result":{"data":{"markdownRemark":{"id":"be1be0dc-f7ef-50d9-ac9c-7b5a27e04eb3","html":"<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#0-%E5%89%8D%E8%A8%80\">0. 前言</a></li>\n<li>\n<p><a href=\"#1-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\">1. 准备工作</a></p>\n<ul>\n<li><a href=\"#11-android%E6%96%87%E4%BB%B6%E5%A4%B9\">1.1 Android文件夹</a></li>\n<li><a href=\"#12-ios%E6%96%87%E4%BB%B6%E5%A4%B9\">1.2 iOS文件夹</a></li>\n</ul>\n</li>\n<li><a href=\"#2-java%E5%8F%8D%E7%BC%96%E8%AF%91\">2. JAVA反编译</a></li>\n<li><a href=\"#3-dll%E5%8F%8D%E7%BC%96%E8%AF%91\">3. DLL反编译</a></li>\n<li><a href=\"#4-so%E5%8F%8D%E7%BC%96%E8%AF%91\">4. SO反编译</a></li>\n<li>\n<p><a href=\"#5-unity%E8%B5%84%E6%BA%90%E8%A7%A3%E5%8C%85\">5. Unity资源解包</a></p>\n<ul>\n<li><a href=\"#51-unity-studio\">5.1 Unity Studio</a></li>\n<li><a href=\"#52-unity-assets-bundle-extractor\">5.2 Unity Assets Bundle Extractor</a></li>\n<li><a href=\"#53-disunity\">5.3 DisUnity</a></li>\n<li><a href=\"#54-python-unitypack\">5.4 python-unitypack</a></li>\n</ul>\n</li>\n<li><a href=\"#6-%E8%AF%BB%E4%BB%A3%E7%A0%81\">6. 读代码</a></li>\n</ul>\n</div>\n<h2 id=\"0-前言\" style=\"position:relative;\"><a href=\"#0-%E5%89%8D%E8%A8%80\" aria-label=\"0 前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 前言</h2>\n<p>最近也算是开始入坑玩起了移动游戏，同时对游戏的机制和技术也产生了很大兴趣。加上之前很早就想参与下移动应用的开发和移动游戏的开发，于是就想尝试下反向工程该游戏。下文的内容权作笔记。</p>\n<h2 id=\"1-准备工作\" style=\"position:relative;\"><a href=\"#1-%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C\" aria-label=\"1 准备工作 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 准备工作</h2>\n<p>下载游戏的apk和ipa，把后缀名改成zip解压，获得两个版本的文件夹。</p>\n<h3 id=\"11-android文件夹\" style=\"position:relative;\"><a href=\"#11-android%E6%96%87%E4%BB%B6%E5%A4%B9\" aria-label=\"11 android文件夹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.1 Android文件夹</h3>\n<ul>\n<li>assets：游戏主体，基本上游戏内容都在这里</li>\n<li>classes.dex：和平台相关的JAVA代码，反编译可以获得源代码</li>\n<li>lib：都是so文件，游戏运行需要的一系列基本平台类库</li>\n<li>res：应用程序的各种资源，主要是icon，各种尺寸</li>\n</ul>\n<p>游戏代码位置：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">assets/bin/Data/Managed</code></pre></div>\n<h3 id=\"12-ios文件夹\" style=\"position:relative;\"><a href=\"#12-ios%E6%96%87%E4%BB%B6%E5%A4%B9\" aria-label=\"12 ios文件夹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.2 iOS文件夹</h3>\n<p>根目录 <code class=\"language-text\">Payload</code> 文件夹下只有一个文件夹 <code class=\"language-text\">fatego.app</code>，有用的东西都在 Data 下面，<code class=\"language-text\">Managed</code> 下面是代码，其他基本上都是资源。</p>\n<h2 id=\"2-java反编译\" style=\"position:relative;\"><a href=\"#2-java%E5%8F%8D%E7%BC%96%E8%AF%91\" aria-label=\"2 java反编译 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. JAVA反编译</h2>\n<p>反编译dex文件到jar文件，使用命令行工具：<code class=\"language-text\">dex2jar</code>\n安装：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> dex2jar --verbose</code></pre></div>\n<p>安装完之后你找不到这个命令。。。\n该软件命令都是以 <code class=\"language-text\">d2j-*</code> 开头的，这里我们要用的是：<code class=\"language-text\">d2j-dex2jar</code></p>\n<p>执行命令：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">d2j-dex2jar classes.dex</code></pre></div>\n<p>会在同目录创建一个新文件：<code class=\"language-text\">classes-dex2jar.jar</code></p>\n<p>使用<code class=\"language-text\">JD-GUI</code>这个软件来打开并查看其中的JAVA代码，主页：<a href=\"http://jd.benow.ca/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">链接</a></p>\n<p>当然，因为Unity游戏项目的代码是跨平台的，因此Android平台的class文件内没有什么有价值的东西需要我们仔细阅读。</p>\n<h2 id=\"3-dll反编译\" style=\"position:relative;\"><a href=\"#3-dll%E5%8F%8D%E7%BC%96%E8%AF%91\" aria-label=\"3 dll反编译 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. DLL反编译</h2>\n<p>Unity的游戏代码是放在上面所说的<code class=\"language-text\">Managed</code>文件夹下，游戏代码会被封装成一个DLL：<code class=\"language-text\">Assembly-CSharp.dll</code>\n因此我们需要将这个DLL反编译成C#代码。这里使用的工具是<code class=\"language-text\">ILSpy</code>，但这款软件是没有MAC版的，在google上找到了MAC的替代品：<a href=\"https://github.com/aerror2/ILSpy-For-MacOSX\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">aerror2/ILSpy-For-MacOSX</a></p>\n<p>这款软件的安装和使用还有点意思，首先需要安装<code class=\"language-text\">Xamarin Studio</code>：<a href=\"https://www.xamarin.com/download\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">下载</a>\n装完了估计还得下载安装<code class=\"language-text\">Mono套件</code>，这东西不需要担心，在启动<code class=\"language-text\">Xamarin Studio</code>的时候会提示你没有runtime，需要下载。</p>\n<p>接下来：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone git@github.com:aerror2/ILSpy-For-MacOSX.git</code></pre></div>\n<p>使用<code class=\"language-text\">Xamarin Studio</code>打开克隆下来的sln项目，构建Build完成，生成：<code class=\"language-text\">ILSpyMac/bin/Debug</code>\n该文件夹下都是构建出来的可执行文件，我们需要使用的是：<code class=\"language-text\">ILSpyMac.exe</code>\n接下来执行命令：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">mono ILSpyMac.exe -n 随便输入点名字 DLL文件所在的文件夹</code></pre></div>\n<p>这个命令会扫描刚才输入的<code class=\"language-text\">DLL文件所在的文件夹</code>，为每个DLL文件创建同名的文件夹，文件夹内都是DLL内解析出来的C#代码文件</p>\n<h2 id=\"4-so反编译\" style=\"position:relative;\"><a href=\"#4-so%E5%8F%8D%E7%BC%96%E8%AF%91\" aria-label=\"4 so反编译 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. SO反编译</h2>\n<p>MAC下主要是使用工具：<a href=\"https://www.hopperapp.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hopper Disassembler</a>\n这是一个付费软件，自己找破解吧。</p>\n<h2 id=\"5-unity资源解包\" style=\"position:relative;\"><a href=\"#5-unity%E8%B5%84%E6%BA%90%E8%A7%A3%E5%8C%85\" aria-label=\"5 unity资源解包 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Unity资源解包</h2>\n<p>资源文件都放在Data文件夹下：\niOS：<code class=\"language-text\">Payload/fatego.app/Data/</code>\nAndroid：<code class=\"language-text\">assets/bin/Data/</code>\n以<code class=\"language-text\">assets</code>为后缀名</p>\n<p>这里我们需要工具来解包资源文件，解出我们可理解的图片、文本、模型、音频文件。找这个工具不算顺利，以引擎来看Unity版本更新不算慢，导致工具必须频繁，而不知道为什么，做工具的人也不多，这里我把我用过的踩过坑的历史都写下，以作笔记。\n从结论上来说，现行可用的基本上只有<code class=\"language-text\">5.4 python-unitypack</code></p>\n<h3 id=\"51-unity-studio\" style=\"position:relative;\"><a href=\"#51-unity-studio\" aria-label=\"51 unity studio permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.1 Unity Studio</h3>\n<p>主页：<a href=\"https://github.com/RaduMC/UnityStudio\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RaduMC/UnityStudio</a>\n介绍：Unity Studio is a tool for exploring, extracting and exporting assets from Unity games and apps.</p>\n<p>下载下来是windows下的可执行文件，即exe，MAC和Linux不可用。尝试使用了下，打开assets包是可以，但解包就假死，错误信息没有仔细看，估计是资源包内的格式不支持之类的错误。</p>\n<p>Update 2016-11-25:\n找到了作者的<a href=\"http://www.perfare.net/650.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">博客</a>，11.08刚更新到v0.6.4版本。不过这个版本下载下来也仍旧有报错。\n最后用Windows机器clone了代码库，用VS自己编译了一个版本，这个倒是可以用。将assets整个导出后，Texture2D的文件都是pvr，后面要找工具看是否能转换pvr到png之类的。 </p>\n<p>Update 2016-11-27:\n在我的WIN7机器上做实验，build出来的版本2D贴图解析肯定有问题，所有的图片不是黑的就是不显示，而使用0.6.4作者官方的最新版本，除了会报<code class=\"language-text\">无法加载 DLL“PVRTexLibWrapper.dll”</code>之外，非PVR格式的图片都是可以正常预览的。\n在作者的博客上找到了一个<a href=\"http://www.perfare.net/617.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">提示</a></p>\n<blockquote>\n<p>64位需要Visual C++ 2015</p>\n</blockquote>\n<p>尝试到微软官方页面上<a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=53840\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">下载</a>然后安装了，结果仍旧没有解决问题。这块仍旧需要Debug。\n但至少知道这个工具的贴图相关技术还是可用的，不过当前PVR的DLL链接有问题。</p>\n<p>Update 2016-11-30:\n两次Update里的作者是中国人，非标题下列的原库的作者，所述的库是一个fork库：\n<a href=\"https://github.com/Perfare/UnityStudio\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Perfare/UnityStudio</a></p>\n<h3 id=\"52-unity-assets-bundle-extractor\" style=\"position:relative;\"><a href=\"#52-unity-assets-bundle-extractor\" aria-label=\"52 unity assets bundle extractor permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.2 Unity Assets Bundle Extractor</h3>\n<p>主页：<a href=\"https://github.com/DerPopo/UABE\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DerPopo/UABE</a>\n论坛：<a href=\"https://7daystodie.com/forums/showthread.php?22675-Unity-Assets-Bundle-Extractor\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unity Assets Bundle Extractor</a>\n介绍：Unity .assets and AssetBundle editor</p>\n<p>下载下来就只有一个exe文件，打开就报错说一个DLL不存在，也是不知道怎么用。</p>\n<p>Update 2016-11-25:\n之前下的2.0b版本有问题，只有一个可执行文件，前面的几个版本（2.0b之前，含2.0）都是完整的包，可以使用。不过这个软件的导出功能不是很好用，也没有批量操作。</p>\n<h3 id=\"53-disunity\" style=\"position:relative;\"><a href=\"#53-disunity\" aria-label=\"53 disunity permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.3 DisUnity</h3>\n<p>主页：<a href=\"https://github.com/ata4/disunity\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ata4/disunity</a>\n介绍：An experimental command-line toolset for Unity asset and asset bundle files written in Java, mostly designed for extraction.</p>\n<p>0.3、0.4、0.5每个版本貌似都是跟进Unity的版本。当前最流行的是 Unity5，但该工具的0.5版本只是一个半成品，可以读assets，但无法解包，是一个废品。\n之前最主流的解包工具就是这款，不知道为什么现在完全不行。该工具使用java编写，支持多平台。</p>\n<h3 id=\"54-python-unitypack\" style=\"position:relative;\"><a href=\"#54-python-unitypack\" aria-label=\"54 python unitypack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.4 python-unitypack</h3>\n<p>主页：<a href=\"https://github.com/HearthSim/UnityPack/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">HearthSim/UnityPack</a>\n介绍：A library to deserialize Unity3D Assets and AssetBundles files (*.unity3d).</p>\n<p>Python的命令行工具，也可以作为python的代码包来使用在代码中。该工具使用python3编写，使用需要先安装python3：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">brew <span class=\"token function\">install</span> python3 --verbose</code></pre></div>\n<p>然后安装工具：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone git@github.com:HearthSim/UnityPack.git\n<span class=\"token builtin class-name\">cd</span> UnityPack\n./setup.py <span class=\"token function\">install</span></code></pre></div>\n<p>接下来就可以使用命令进行解包了：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">unityextract --all -o 资源导出路径 ASSETS文件路径</code></pre></div>\n<p>使用后发现贴图Texture的解包需要额外安装东西：</p>\n<blockquote>\n<p>Texture2D objects will be converted to png files. Not all Texture2D formats are supported. Pillow version >= 3.4 is required for this.</p>\n</blockquote>\n<p>该类库的页面在：<a href=\"https://pillow.readthedocs.io/en/latest/installation.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Pillow (PIL Fork)</a></p>\n<p>安装完毕后，解包脚本即可解包贴图Texture了。</p>\n<p>后续又发现了新问题，Android和iOS的贴图压缩算法在解包工具的当前版本中没有被处理，解包会报错：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">Android:\nNotImplementedError: Unimplemented <span class=\"token function\">format</span> <span class=\"token operator\">&lt;</span>TextureFormat.ETC_RGB4: <span class=\"token number\">3</span><span class=\"token operator\"><span class=\"token file-descriptor important\">4</span>></span>\niOS:\nNotImplementedError: Unimplemented <span class=\"token function\">format</span> <span class=\"token operator\">&lt;</span>TextureFormat.PVRTC_RGB4: <span class=\"token number\">3</span><span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span></code></pre></div>\n<p>待解决</p>\n<h2 id=\"6-读代码\" style=\"position:relative;\"><a href=\"#6-%E8%AF%BB%E4%BB%A3%E7%A0%81\" aria-label=\"6 读代码 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. 读代码</h2>\n<p>在代码反编译完成后，可以使用<code class=\"language-text\">Xamarin Studio</code>载入代码，方便进行代码阅读。</p>\n<p><strong>UPDATE 20161130</strong>：\n暂停该工作，优先级较低，进度有问题。任务先转到别的工作。</p>\n<blockquote>\n<p>EOF</p>\n</blockquote>","fields":{"slug":"/posts/2016/11/mobile-reverse-code-engineering","tagSlugs":["/tag/mobile-dev/","/tag/reverse-code-engineering/","/tag/android/","/tag/i-os/","/tag/unity/"]},"frontmatter":{"date":"2016-11-22T15:46:37.121Z","description":"","tags":["MobileDev","ReverseCodeEngineering","Android","iOS","Unity"],"title":"移动应用逆向工程","socialImage":{"publicURL":"/static/7e722e026a41a08a8f9a1cc76782dd27/default-social-image.jpg"}}}},"pageContext":{"slug":"/posts/2016/11/mobile-reverse-code-engineering"}},"staticQueryHashes":["251939775","401334301","825871152"]}