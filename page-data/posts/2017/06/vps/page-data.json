{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/2017/06/vps","result":{"data":{"markdownRemark":{"id":"49614286-1abd-5e55-91e6-613e09e4d3d7","html":"<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#0-%E5%89%8D%E8%A8%80\">0. 前言</a></li>\n<li><a href=\"#1-vps\">1. VPS</a></li>\n<li><a href=\"#2-%E5%AE%89%E8%A3%85\">2. 安装</a>\n<ul>\n<li><a href=\"#20-%E7%B3%BB%E7%BB%9F\">2.0 系统</a></li>\n<li><a href=\"#21-%E5%90%AF%E7%94%A8bbr\">2.1 启用BBR</a></li>\n<li><a href=\"#21-%E5%AE%89%E8%A3%85libsodium\">2.1 安装libsodium</a></li>\n<li><a href=\"#22-%E5%AE%89%E8%A3%85ss\">2.2 安装SS</a></li>\n<li><a href=\"#23-%E5%AE%89%E8%A3%85python\">2.3 安装python</a></li>\n<li><a href=\"#24-%E5%88%9B%E5%BB%BA%E5%91%BD%E4%BB%A4%E8%84%9A%E6%9C%AC%E5%92%8C%E8%BF%90%E7%BB%B4%E7%8E%AF%E5%A2%83\">2.4 创建命令脚本和运维环境</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"0-前言\" style=\"position:relative;\"><a href=\"#0-%E5%89%8D%E8%A8%80\" aria-label=\"0 前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 前言</h2>\n<p>GreenVPN本周挂了，噩耗啊。服务时间最长，我觉得应该是一辈子不会挂的最后防线居然就这么轻易挂了。看来还是得自己搭VPS作为自己的最后防线。否则第三方的服务哪天挂了，我真的就闭耳塞听了。</p>\n<h2 id=\"1-vps\" style=\"position:relative;\"><a href=\"#1-vps\" aria-label=\"1 vps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. VPS</h2>\n<p>名字就不提了，反正越少人知道越好。本来想用$2.5的Instance，卖完了。接着想索性换一样价格的Linode，结果Linode的$5也卖完了。最后还是用了$5的Instance，等有$2.5的时候再换下来。</p>\n<h2 id=\"2-安装\" style=\"position:relative;\"><a href=\"#2-%E5%AE%89%E8%A3%85\" aria-label=\"2 安装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 安装</h2>\n<h3 id=\"20-系统\" style=\"position:relative;\"><a href=\"#20-%E7%B3%BB%E7%BB%9F\" aria-label=\"20 系统 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.0 系统</h3>\n<p>操作系统选的是最新的ubuntu，17.04</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> /etc/issue\n<span class=\"token comment\"># Ubuntu 17.04 \\n \\l</span>\n<span class=\"token function\">sudo</span> lsb_release <span class=\"token parameter variable\">-a</span>\n<span class=\"token comment\"># No LSB modules are available.</span>\n<span class=\"token comment\"># Distributor ID:\tUbuntu</span>\n<span class=\"token comment\"># Description:\tUbuntu 17.04</span>\n<span class=\"token comment\"># Release:\t17.04</span>\n<span class=\"token comment\"># Codename:\tzesty</span>\n<span class=\"token function\">uname</span> <span class=\"token parameter variable\">-r</span>\n<span class=\"token comment\"># 4.10.0-20-generic</span></code></pre></div>\n<h3 id=\"21-启用bbr\" style=\"position:relative;\"><a href=\"#21-%E5%90%AF%E7%94%A8bbr\" aria-label=\"21 启用bbr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.1 启用BBR</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"net.core.default_qdisc=fq\"</span> <span class=\"token operator\">>></span> /etc/sysctl.conf\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"net.ipv4.tcp_congestion_control=bbr\"</span> <span class=\"token operator\">>></span> /etc/sysctl.conf\n<span class=\"token function\">sysctl</span> <span class=\"token parameter variable\">-p</span> /etc/sysctl.conf\n<span class=\"token comment\"># net.ipv6.conf.all.accept_ra = 2</span>\n<span class=\"token comment\"># net.core.default_qdisc = fq</span>\n<span class=\"token comment\"># net.ipv4.tcp_congestion_control = bbr</span>\n<span class=\"token function\">sysctl</span> net.ipv4.tcp_available_congestion_control\n<span class=\"token comment\"># net.ipv4.tcp_available_congestion_control = bbr cubic reno</span>\nlsmod <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> bbr\n<span class=\"token comment\"># tcp_bbr                20480  0</span></code></pre></div>\n<h3 id=\"21-安装libsodium\" style=\"position:relative;\"><a href=\"#21-%E5%AE%89%E8%A3%85libsodium\" aria-label=\"21 安装libsodium permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.1 安装libsodium</h3>\n<p>详见：<a href=\"https://github.com/breakwa11/shadowsocks-rss/wiki/libsodium\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Link</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> build-essential\n<span class=\"token function\">wget</span> https://github.com/jedisct1/libsodium/releases/download/1.0.12/libsodium-1.0.12.tar.gz\n<span class=\"token function\">tar</span> xf libsodium-1.0.12.tar.gz <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> libsodium-1.0.12\n./configure <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token parameter variable\">-j2</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">make</span> <span class=\"token function\">install</span>\nldconfig</code></pre></div>\n<h3 id=\"22-安装ss\" style=\"position:relative;\"><a href=\"#22-%E5%AE%89%E8%A3%85ss\" aria-label=\"22 安装ss permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.2 安装SS</h3>\n<p>详见：<a href=\"https://github.com/breakwa11/shadowsocks-rss/wiki/Server-Setup\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Link</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone <span class=\"token parameter variable\">-b</span> manyuser https://github.com/shadowsocksr/shadowsocksr.git\n<span class=\"token builtin class-name\">cd</span> shadowsocksr\n<span class=\"token function\">bash</span> initcfg.sh</code></pre></div>\n<h3 id=\"23-安装python\" style=\"position:relative;\"><a href=\"#23-%E5%AE%89%E8%A3%85python\" aria-label=\"23 安装python permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.3 安装python</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> checkinstall\n<span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> libreadline-gplv2-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev\n\n<span class=\"token function\">wget</span> https://www.python.org/ftp/python/2.7.13/Python-2.7.13.tgz\n<span class=\"token function\">tar</span> xzf Python-2.7.13.tgz\n<span class=\"token builtin class-name\">cd</span> Python-2.7.13\n./configure\n<span class=\"token function\">make</span> <span class=\"token function\">install</span></code></pre></div>\n<h3 id=\"24-创建命令脚本和运维环境\" style=\"position:relative;\"><a href=\"#24-%E5%88%9B%E5%BB%BA%E5%91%BD%E4%BB%A4%E8%84%9A%E6%9C%AC%E5%92%8C%E8%BF%90%E7%BB%B4%E7%8E%AF%E5%A2%83\" aria-label=\"24 创建命令脚本和运维环境 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.4 创建命令脚本和运维环境</h3>\n<p>修改文件limit</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"fs.file-max=1024000\"</span> <span class=\"token operator\">>></span> /etc/sysctl.conf\n<span class=\"token function\">sysctl</span> <span class=\"token parameter variable\">-p</span> /etc/sysctl.conf\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"*               soft    nofile           512000\"</span> <span class=\"token operator\">>></span> /etc/security/limits.conf\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"*               hard    nofile          1024000\"</span> <span class=\"token operator\">>></span> /etc/security/limits.conf</code></pre></div>\n<p>日志和启动文件</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">touch</span> shadowsocks.sh\n<span class=\"token function\">chmod</span> +x ./shadowsocks.sh\n<span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> /var/log/shadowsocksr.log ./shadowsocksr.log</code></pre></div>\n<p>vim shadowsocks.sh</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n<span class=\"token assign-left variable\">BASEDIR</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">dirname</span> <span class=\"token string\">\"<span class=\"token variable\">$0</span>\"</span><span class=\"token variable\">)</span></span>\n<span class=\"token assign-left variable\">CMD</span><span class=\"token operator\">=</span><span class=\"token variable\">${BASEDIR}</span>/shadowsocksr/shadowsocks/server.py\n<span class=\"token assign-left variable\">CONF</span><span class=\"token operator\">=</span><span class=\"token variable\">${BASEDIR}</span>/shadowsocksr/user-config.json\n\n<span class=\"token builtin class-name\">cd</span> <span class=\"token variable\">${BASEDIR}</span>\n\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"start\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">ulimit</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">512000</span>\n    python <span class=\"token variable\">${CMD}</span> <span class=\"token parameter variable\">-c</span> <span class=\"token variable\">${CONF}</span> <span class=\"token parameter variable\">-d</span> start\n<span class=\"token keyword\">elif</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"restart\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">ulimit</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">512000</span>\n    python <span class=\"token variable\">${CMD}</span> <span class=\"token parameter variable\">-c</span> <span class=\"token variable\">${CONF}</span> <span class=\"token parameter variable\">-d</span> restart\n<span class=\"token keyword\">elif</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"stop\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><span class=\"token keyword\">then</span>\n    <span class=\"token builtin class-name\">ulimit</span> <span class=\"token parameter variable\">-n</span> <span class=\"token number\">512000</span>\n    python <span class=\"token variable\">${CMD}</span> <span class=\"token parameter variable\">-c</span> <span class=\"token variable\">${CONF}</span> <span class=\"token parameter variable\">-d</span> stop\n<span class=\"token keyword\">else</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Usage: ./shadowsocks.sh start|stop|restart\"</span>\n<span class=\"token keyword\">fi</span></code></pre></div>\n<p>vim shadowsocksr/user-config.json</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"server\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"server_ipv6\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"::\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"server_port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">8038</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"local_address\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"local_port\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1080</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$URPWD\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"aes-256-cfb\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"protocol\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"auth_aes128_md5\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"protocol_param\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"obfs\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"http_simple\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"obfs_param\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"speed_limit_per_con\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"speed_limit_per_user\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token property\">\"additional_ports\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"additional_ports_only\"</span> <span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"timeout\"</span><span class=\"token operator\">:</span> <span class=\"token number\">120</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"udp_timeout\"</span><span class=\"token operator\">:</span> <span class=\"token number\">60</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"dns_ipv6\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"connect_verbose_info\"</span><span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"redirect\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"bing.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"cloudflare.com:443\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"fast_open\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>MAC客户端安装基本上和服务器差不多，git clone下来，bash生成config json，从服务器拷贝一份也行。然后只要把客户端的port和服务端的ip配下，就好了。<br>\nMAC自启动脚本<br>\nvim org.shadowsocks.macos.plist</p>\n<div class=\"gatsby-highlight\" data-language=\"xml\"><pre class=\"language-xml\"><code class=\"language-xml\"><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span>\n<span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">plist</span> <span class=\"token name\">PUBLIC</span> <span class=\"token string\">\"-//Apple//DTD PLIST 1.0//EN\"</span> <span class=\"token string\">\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>plist</span> <span class=\"token attr-name\">version</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dict</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>GroupName<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>wheel<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>KeepAlive<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dict</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>SuccessfulExit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>false</span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dict</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>Label<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>org.shadowsocksr.macos<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>WorkingDirectory<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>$PATH_TO_shadowsocksr<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>ProgramArguments<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>array</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/usr/bin/python<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>shadowsocks/local.py<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>-c<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>user-config.json<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>-d<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>start<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>array</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>RunAtLoad<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>true</span><span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>StandardErrorPath<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/var/log/shadowsocksr.log<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>StandardOutPath<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>/var/log/shadowsocksr.log<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>key</span><span class=\"token punctuation\">></span></span>UserName<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>key</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>string</span><span class=\"token punctuation\">></span></span>root<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>string</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dict</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>plist</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>MAC启动</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> /Library/LaunchDaemons/org.shadowsocks.macos.plist\n<span class=\"token function\">sudo</span> launchctl load ./org.shadowsocks.macos.plist</code></pre></div>\n<p>观察日志</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">tail</span> <span class=\"token parameter variable\">-f</span> ./shadowsocksr.log</code></pre></div>\n<blockquote>\n<p>EOF</p>\n</blockquote>","fields":{"slug":"/posts/2017/06/vps","tagSlugs":["/tag/vultr/","/tag/vps/"]},"frontmatter":{"date":"2017-06-25T04:33:22.000Z","description":"","tags":["Vultr","VPS"],"title":"自建SS安装","socialImage":"/media/default-social-image.jpg"}},"allFile":{"totalCount":0,"nodes":[]}},"pageContext":{"slug":"/posts/2017/06/vps","gallery":"media/posts/2017/06/vps/gallery"}},"staticQueryHashes":["251939775","357378587","401334301"]}