{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/2018/01/node-profile","result":{"data":{"markdownRemark":{"id":"60fc4bab-e5d4-5325-8c36-ec4f4fc1f462","html":"<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#0-%E5%89%8D%E8%A8%80\">0. 前言</a></p>\n<ul>\n<li><a href=\"#%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF\">版本信息</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#1-%E5%86%85%E5%AD%98-memory\">1. 内存 Memory</a></p>\n<ul>\n<li><a href=\"#11-v8%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6\">1.1 V8内存机制</a></li>\n<li><a href=\"#12-v8-gc%E8%AF%A6%E8%A7%A3\">1.2 V8 GC详解</a></li>\n<li><a href=\"#13-node%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7%E5%AE%9E%E8%B7%B5\">1.3 Node内存监控实践</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF-eventloop\">2. 事件循环 EventLoop</a></p>\n<ul>\n<li><a href=\"#21-eventloop-lag\">2.1 EventLoop Lag</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-cpu\">3. CPU</a></p>\n<ul>\n<li><a href=\"#31-cpu-usage\">3.1 CPU Usage</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-profile\">4. Profile</a></p>\n<ul>\n<li><a href=\"#41-profile%E5%AE%9E%E8%B7%B5\">4.1 Profile实践</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"0-前言\" style=\"position:relative;\"><a href=\"#0-%E5%89%8D%E8%A8%80\" aria-label=\"0 前言 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>0. 前言</h2>\n<p>知其然，知其所以然。作为后端程序，如果对所用的工具没有一定程度的了解，还真不敢放到线上进行运行。否则出了问题，如何解决都没谱，到时候可是线上事故。</p>\n<p>本文主要在于以下几个方面，不局限于狭义的<code class=\"language-text\">profile</code>或<code class=\"language-text\">profiler</code>：</p>\n<ul>\n<li>Node 的性能Metrics：到底哪些进程指标是我们需要关心需要监控的</li>\n<li>Node 的Profiler：如何对进程进行profile，获取核心metrics</li>\n<li>Node 的GC：Memory以及GC相关的知识点，以及如何进行profile和观察，当然也需要关注memory leak及如何查找问题</li>\n</ul>\n<h3 id=\"版本信息\" style=\"position:relative;\"><a href=\"#%E7%89%88%E6%9C%AC%E4%BF%A1%E6%81%AF\" aria-label=\"版本信息 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>版本信息</h3>\n<p>本文行文依据的Node版本，及所有范例的运行环境为：</p>\n<blockquote>\n<p>Node version:<br>\nv8.4.0<br>\nNode v8 version:<br>\n6.0.286.52</p>\n</blockquote>\n<p>本文撰写时候最新的LTS版本为：</p>\n<blockquote>\n<p>v8.9.4</p>\n</blockquote>\n<p>Node的Changelog可以在<a href=\"https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V8.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">这里</a>找到</p>\n<p>一般只要版本差异不要太大，信息的可靠性都应该没有问题。但如果版本差异过大，请自行进行信息修正，毕竟Node的发展实在是太快。</p>\n<h2 id=\"1-内存-memory\" style=\"position:relative;\"><a href=\"#1-%E5%86%85%E5%AD%98-memory\" aria-label=\"1 内存 memory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 内存 Memory</h2>\n<h3 id=\"11-v8内存机制\" style=\"position:relative;\"><a href=\"#11-v8%E5%86%85%E5%AD%98%E6%9C%BA%E5%88%B6\" aria-label=\"11 v8内存机制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.1 <a href=\"/2018/01/node-memory/\">V8内存机制</a></h3>\n<h3 id=\"12-v8-gc详解\" style=\"position:relative;\"><a href=\"#12-v8-gc%E8%AF%A6%E8%A7%A3\" aria-label=\"12 v8 gc详解 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.2 <a href=\"/2018/01/node-v8-gc/\">V8 GC详解</a></h3>\n<h3 id=\"13-node内存监控实践\" style=\"position:relative;\"><a href=\"#13-node%E5%86%85%E5%AD%98%E7%9B%91%E6%8E%A7%E5%AE%9E%E8%B7%B5\" aria-label=\"13 node内存监控实践 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.3 <a href=\"/2018/02/node-memory-monitor/\">Node内存监控实践</a></h3>\n<h2 id=\"2-事件循环-eventloop\" style=\"position:relative;\"><a href=\"#2-%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF-eventloop\" aria-label=\"2 事件循环 eventloop permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 事件循环 EventLoop</h2>\n<h3 id=\"21-eventloop-lag\" style=\"position:relative;\"><a href=\"#21-eventloop-lag\" aria-label=\"21 eventloop lag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.1 <a href=\"/2018/03/node-event-loop/\">EventLoop Lag</a></h3>\n<h2 id=\"3-cpu\" style=\"position:relative;\"><a href=\"#3-cpu\" aria-label=\"3 cpu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. CPU</h2>\n<h3 id=\"31-cpu-usage\" style=\"position:relative;\"><a href=\"#31-cpu-usage\" aria-label=\"31 cpu usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1 <a href=\"/2018/03/node-profile-cpu/\">CPU Usage</a></h3>\n<h2 id=\"4-profile\" style=\"position:relative;\"><a href=\"#4-profile\" aria-label=\"4 profile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Profile</h2>\n<h3 id=\"41-profile实践\" style=\"position:relative;\"><a href=\"#41-profile%E5%AE%9E%E8%B7%B5\" aria-label=\"41 profile实践 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4.1 <a href=\"/2018/02/node-profile-practice/\">Profile实践</a></h3>\n<blockquote>\n<p>EOF</p>\n</blockquote>","fields":{"slug":"/posts/2018/01/node-profile","tagSlugs":["/tag/java-script/","/tag/performance/","/tag/profile/","/tag/memory/","/tag/cpu/","/tag/monitor/","/tag/metrics/","/tag/keynote/"]},"frontmatter":{"date":"2018-01-19T02:33:22.000Z","description":"","tags":["JavaScript","Performance","Profile","Memory","CPU","Monitor","Metrics","Keynote"],"title":"Node.JS Profile","socialImage":{"publicURL":"/static/7e722e026a41a08a8f9a1cc76782dd27/default-social-image.jpg"}}},"allFile":{"totalCount":0,"nodes":[]}},"pageContext":{"slug":"/posts/2018/01/node-profile","gallery":"media/posts/2018/01/node-profile/gallery"}},"staticQueryHashes":["251939775","401334301","825871152"]}