{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/2022/09/git-revert-trap","result":{"data":{"markdownRemark":{"id":"0df09ef7-5da5-59b6-a0fd-25205e1aac22","html":"<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#1-see-an-example\">1. See an example</a></li>\n</ul>\n</div>\n<h1 id=\"1-see-an-example\" style=\"position:relative;\"><a href=\"#1-see-an-example\" aria-label=\"1 see an example permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. See an example</h1>\n<p>Letâ€™s see an example</p>\n<p>Step 1. Init dir <code class=\"language-text\">git_test</code> and git repo</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ~/Downloads <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> git_test <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> git_test <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> init <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'console.log(\"This is init\");'</span> <span class=\"token operator\">></span> index.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"init commit\"</span></code></pre></div>\n<p>Step 2. Create branches: <code class=\"language-text\">develop</code>, <code class=\"language-text\">feat-x</code>, <code class=\"language-text\">release</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> branch develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> checkout develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'console.log(\"This is commit in develop\");'</span> <span class=\"token operator\">>></span> index.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"develop commit\"</span>\n\n<span class=\"token function\">git</span> branch feat-x <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> branch release</code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/01.jpg\" alt=\"\"></p>\n<p>Step 3. In branch <code class=\"language-text\">feat-x</code>, add one file <code class=\"language-text\">x.js</code> and append some codes in previous <code class=\"language-text\">index.js</code>, then merge it to <code class=\"language-text\">develop</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout feat-x <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'console.log(\"code x file\");'</span> <span class=\"token operator\">></span> x.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'console.log(\"feat x changes\");'</span> <span class=\"token operator\">|</span> <span class=\"token function\">cat</span> - index.js <span class=\"token operator\">></span> /tmp/out <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">mv</span> /tmp/out index.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"feat: x commit\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> checkout develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> merge feat-x --no-ff</code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/02.jpg\" alt=\"\"></p>\n<p>Step 4. Now revert this merged commit on <code class=\"language-text\">develop</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> revert 6aa7c6550c182605a24c95a41b7d32939f9e346f</code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/03.jpg\" alt=\"\"></p>\n<p>Step 5. Go to <code class=\"language-text\">release</code>, make some commits</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout release <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'console.log(\"release changes1\");'</span> <span class=\"token operator\">>></span> index.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"release: change1\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'console.log(\"release changes2\");'</span> <span class=\"token operator\">>></span> index.js <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit <span class=\"token parameter variable\">-m</span> <span class=\"token string\">\"release: change2\"</span></code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/04.jpg\" alt=\"\"></p>\n<p>Step 6. Merge <code class=\"language-text\">feat-x</code> to <code class=\"language-text\">release</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout release <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> merge feat-x --no-ff</code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/05.jpg\" alt=\"\"></p>\n<p>Step 7. Merge <code class=\"language-text\">release</code> to <code class=\"language-text\">develop</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> merge release --no-ff</code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/06.jpg\" alt=\"\">\n<img src=\"/media/posts/2022/09/git-revert-trap/07.jpg\" alt=\"\"></p>\n<p>See the branch <code class=\"language-text\">develop</code>, you will find there is no changes belong to <code class=\"language-text\">feat-x</code>. We have this branch merged to develop previously, and we reverted that commit. Later we have commit merged from <code class=\"language-text\">feat-x</code> to <code class=\"language-text\">release</code> then <code class=\"language-text\">release</code> to <code class=\"language-text\">develop</code>. But as you can see, even this commit merged with <code class=\"language-text\">release</code> branch to <code class=\"language-text\">develop</code> later (means this commit merged to <code class=\"language-text\">develop</code> twice), it still not in the <code class=\"language-text\">develop</code>.</p>\n<p>How to fix this:</p>\n<ul>\n<li>make a new branch <code class=\"language-text\">fix</code></li>\n<li>cherry-pick the commit belongs to <code class=\"language-text\">feat-x</code></li>\n<li>merge <code class=\"language-text\">fix</code> to <code class=\"language-text\">develop</code></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> branch fix <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> checkout fix <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n<span class=\"token function\">git</span> cherry-pick 6aa7c6550c182605a24c95a41b7d32939f9e346f</code></pre></div>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/08.jpg\" alt=\"\"></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> checkout develop <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> merge fix --no-ff</code></pre></div>\n<p>See the result:</p>\n<p><img src=\"/media/posts/2022/09/git-revert-trap/09.jpg\" alt=\"\">\n<img src=\"/media/posts/2022/09/git-revert-trap/10.jpg\" alt=\"\"></p>\n<blockquote>\n<p>EOF</p>\n</blockquote>","fields":{"slug":"/posts/2022/09/git-revert-trap","tagSlugs":["/tag/git/"]},"frontmatter":{"date":"2022-09-05T14:09:22.000Z","description":"Commit lost when branch merged with revert command used","tags":["Git"],"title":"Git Revert Trap","socialImage":"/media/default-social-image.jpg"}},"allFile":{"totalCount":0,"nodes":[]}},"pageContext":{"slug":"/posts/2022/09/git-revert-trap","gallery":"media/posts/2022/09/git-revert-trap/gallery"}},"staticQueryHashes":["251939775","357378587","401334301"]}